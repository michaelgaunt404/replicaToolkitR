% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/viz_rplc_study_area_network.R
\name{viz_rplc_study_area_network}
\alias{viz_rplc_study_area_network}
\title{Query Replica's roadway network using an interactive or supplied study area}
\usage{
viz_rplc_study_area_network(
  customer_name,
  links_pro = NA,
  study_area_extent = NULL,
  data_set_location,
  data_set_period
)
}
\arguments{
\item{customer_name}{Character. Replica customer name / BigQuery project ID.
Used to build the network table path (e.g., \code{"my_customer"}).}

\item{links_pro}{Character vector or \code{NA}. Optional user-supplied list of
roadway types to limit the query (e.g., \code{c("primary", "secondary")}).
If \code{NA} and the user chooses to limit the network, a default set of
common roadway types is applied.}

\item{study_area_extent}{\code{sf} object or \code{NULL}. If provided, this
object is used directly as the spatial query extent. If \code{NULL}, the
user is prompted to draw the study area interactively.}

\item{data_set_location}{Character. Replica dataset location tag (e.g.,
\code{"wa"} or \code{"hi"}). Used to construct the network table name.}

\item{data_set_period}{Character. The Replica dataset period identifier
(e.g., \code{"2023_q3"}). Also used to construct the network table name.}
}
\value{
A named list with three objects:
\describe{
  \item{\code{table_network}}{A BigQuery table reference created via \code{bigrquery::bq_project_query()}.}
  \item{\code{table_network_data}}{A data frame of network segments intersecting the study area.}
  \item{\code{sf_network_data}}{An \code{sf} object converted from the table results.}
}
}
\description{
This function retrieves roadway network segments from Replica's BigQuery
dataset based on a user-defined study area. The user may either draw the
study area interactively using \code{mapedit} or supply an existing spatial
object. The function assembles the appropriate network table name based on
customer, dataset location, and dataset period, executes a spatial
intersection query in BigQuery, and returns both tabular and \code{sf} outputs.
}
\details{
Compared to \code{view_replica_study_area_network()}, this updated version:
\itemize{
  \item Allows users to provide their own spatial extent (skipping the drawing step).
  \item Automatically constructs the network table using customer, location,
        and time-period inputs.
  \item Optionally filters results to specific roadway types, either supplied
        through \code{links_pro} or using a built-in default set.
  \item Uses robust internal prompting utilities to confirm user choices
        before running potentially large queries.
}


The function:
\enumerate{
  \item Builds a fully qualified network table name of the form
  \code{<customer_name>.<data_set_location>.<data_set_location>_<data_set_period>_network_segments}.

  \item Obtains a study area geometry by:
    \itemize{
      \item prompting the user to draw one or more polygons, or
      \item using a provided \code{sf} object.
    }

  \item Converts the study area to WKT and runs a BigQuery spatial
        intersection query using \code{ST_INTERSECTS()}.

  \item Optionally limits the query to a specific set of link types, informed
        either by user input or defaults.

  \item Prompts the user to confirm execution after reporting the number of
        candidate roadway segments returned.

  \item Downloads, arranges, and returns both the raw table and \code{sf}
        versions of the network.
}
}
\examples{
\dontrun{

out <- viz_rplc_study_area_network(
  customer_name = "my_customer_id",
  links_pro = NA,
  study_area_extent = NULL,
  data_set_location = "wa",
  data_set_period = "2023_q4"
)
}
}
